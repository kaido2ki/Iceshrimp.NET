@using Iceshrimp.Shared.Schemas

<div class="wrapper" @onclick="Open" @onclick:stopPropagation="true">
    <img class="attachment @(BlurImage ? "blur-image" : "")" src="@Attachment.Url" alt="@Attachment.AltText"/>
</div>

@code {
    [Parameter] [EditorRequired] public required NoteAttachment Attachment { get; set; }
    [Parameter] [EditorRequired] public required EventCallback  OnOpen       { get; set; }

    private bool BlurImage { get; set; }

    private void Open()
    {
        if (BlurImage)
        {
            BlurImage = false;
            StateHasChanged();
        }
        else
        {
            OnOpen.InvokeAsync();
        }
        
    }

    protected override void OnParametersSet()
    {
        BlurImage = Attachment.IsSensitive;
    }
}